<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>게시판</title>
  <link rel="stylesheet" th:href="@{/css/gpt.css}">
</head>
<body class="container">

<script>
    window.onload = function() {
        const postDelete = /*[[${deleteSuccess}]]*/ false;
        if (postDelete){
            alert('글이 삭제되었습니다')
        }
    };
</script>

  <div class="head">
    <a th:href="@{/post/board}">
      <img th:src="@{/image/honey.png}" alt = "메인" class="icon">
    </a>
  </div>
<div>
    <div th:each="category : ${categories}" style="display: inline-block; margin-right: 10px;">
        <a th:href="@{/posts/board(value=${category}, type='type3')}" class="button">
            <span th:text="${category}"></span>
        </a>
    </div>
</div>
  <div id="posts">
    <table class="boardTable">
      <thead>
        <tr>
          <th>번호</th>
          <th>카테고리</th>
          <th>제목</th>
          <th>닉네임</th>
          <th>게시일</th>
        </tr>
      </thead>
      <tbody>

        <tr th:each="post, postStat : ${board}"
        th:if="${postStat.index < page * maxBoard
        and postStat.index >= (page - 1) * maxBoard}">
          <td th:text="${postStat.index + 1}"></td>
          <td th:text="${post.category}"></td>
          <td>
            <a th:href="@{/posts/view(postno=${post.postno})}" th:text="${post.title}"></a>
          </td>
          <td>
            <a th:href="@{/posts/board(value=${post.author}, type='type2')}" th:text="${post.author}"></a>
          </td>
          <td th:text="${post.date}"></td>
        </tr>
      </tbody>
    </table>
      <div th:if="${boardNo == 0}">
          <p>게시물이 없습니다.</p>
      </div>
  </div>
  <p>현재 페이지: <span th:text="${page}"></span></p>
<div th:if="${boardNo > 0}">
  <a class="button" th:each="number : ${#numbers.sequence(1, boardNo)}" th:text="${number}"
     th:href="@{/posts/board(value=${value}, page=${number},
     type=${type}, search=${search}, searchType=${searchType})}">
  </a>
</div>
  <form th:action="@{/posts/board}" method="get">
      <label for="searchOptions"></label>
   <select id="searchOptions" th:field="*{searchType}" onchange="updateType()">
     <option value=""></option>
     <option th:each="option : ${searchOptions}" th:value="${option}" th:text="${option}"></option>
   </select>
    <input type="text" th:field="*{search}" placeholder="검색내용을 입력하세요"
          th:value="${search}"/>
    <input type="hidden" id="searchType" name="searchType" th:value="${searchType}"/>
    <input type="hidden" name="page" th:value="1"/>
   <button type="submit">검색</button>
 </form>
  <script>
    function updateType() {
      const selectedOption = document.getElementById('searchOptions').value;
      const typeInput = document.getElementById('searchType');

      // 선택된 옵션에 따라 type 값을 설정합니다.
      if (selectedOption === '제목') {
        typeInput.value = 'type2';
      } else if (selectedOption === '작성자') {
        typeInput.value = 'type3';
      } else if (selectedOption === '내용') {
          typeInput.value = 'type4';
      } else if (selectedOption === '제목 + 내용') {
          typeInput.value = 'type5';
      } else {
        typeInput.value = 'type1'; // 기본값
      }
    }
  </script>
</body>
</html>
