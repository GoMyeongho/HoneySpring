<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>게시판</title>
  <link rel="stylesheet" th:href="@{/css/gpt.css}">
</head>
<body class="container">

<script>
    window.onload = function() {
        const postDelete = /*[[${deleteSuccess}]]*/ false;
        if (postDelete){
            alert('글이 삭제되었습니다')
        }
    };
</script>

<div th:class="head">
    <a th:href="@{/posts/board}">
        <img th:src="@{/image/honey.png}" alt="게시판" class="icon">
    </a>
    <span>
      <table th:class="mypage-table">
          <thead th:class="mypage-head">
          <tr th:class="mypage-name">
              <!-- isUser가 true일 때는 닉네임 표시, false일 때는 "로그인이 안되어 있습니다" 메시지 표시 -->
              <th th:if="${isUser}" th:text="${user.NName}"></th>
              <th th:unless="${isUser}" class="no-login">로그인이 안되어 있습니다</th>
          </tr>
          </thead>
          <tbody>
          <tr th:class="mypage-select">
              <!-- isUser가 true일 때 마이페이지와 내정보수정 링크 표시 -->
              <td th:if="${isUser}" th:class="mypage-select">
                  <a th:href="@{/users/select}">마이페이지</a>
                  <a th:href="@{/users/update}">내정보수정</a>
              </td>
              <!-- isUser가 false일 때 로그인과 회원가입 링크 표시 -->
              <td th:unless="${isUser}" th:class="mypage-select">
                  <a th:href="@{/users/login}">로그인하기</a>
                  <a th:href="@{/login/signUp}">회원가입</a>
              </td>
          </tr>
          </tbody>
      </table>
    </span>
</div>


<div>
    <div th:each="category : ${categories}" style="display: inline-block; margin-right: 10px;">
        <a th:href="@{/posts/board(value=${category}, type='type3')}" class="button">
            <span th:text="${category}"></span>
        </a>
    </div>
</div>
  <div id="posts">
    <table th:class="board-table">
      <thead>
        <tr>
          <th>번호</th>
          <th>카테고리</th>
          <th>제목</th>
          <th>닉네임</th>
          <th>게시일</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="post, postStat : ${board}"
        th:if="${postStat.index < page * maxBoard
        and postStat.index >= (page - 1) * maxBoard}">
          <td th:class="cell" th:text="${postStat.index + 1}"></td>
          <td th:class="cell" th:text="${post.category}"></td>
          <td>
            <a th:class="button-cell" th:href="@{/posts/view(postno=${post.postno})}" th:text="${post.title}"></a>
          </td>
          <td>
            <a th:class="button-cell" th:href="@{/posts/board(value=${post.author}, type='type2')}" th:text="${post.author}"></a>
          </td>
          <td th:class="cell" th:text="${post.date}"></td>
        </tr>
        <tr th:if="${boardNo == 0}">
            <td></td>
            <td></td>
            <td th:class="cell">게시물이 없습니다.</td>
            <td></td>
        </tr>
      </tbody>
    </table>
  </div>
  <p>현재 페이지:
      <span th:text="${page}"></span>
      <span><a th:class="button" th:href="@{/posts/create}">글 작성</a> </span></p>
<div th:if="${boardNo > 0}">
  <a class="button" th:each="number : ${#numbers.sequence(1, boardNo)}" th:text="${number}"
     th:href="@{/posts/board(value=${value}, page=${number},
     type=${type}, search=${search}, searchType=${searchType})}">
  </a>
</div>
  <form th:action="@{/posts/board}" method="get">
      <label for="searchOptions"></label>
   <select id="searchOptions" th:field="*{searchType}" onchange="updateType()">
     <option value=""></option>
     <option th:each="option : ${searchOptions}" th:value="${option}" th:text="${option}"></option>
   </select>
    <input type="text" th:field="*{search}" placeholder="검색내용을 입력하세요"
          th:value="${search}"/>
    <input type="hidden" id="searchType" name="searchType" th:value="${searchType}"/>
    <input type="hidden" name="page" th:value="1"/>
   <button type="submit">검색</button>
 </form>
  <script>
    function updateType() {
      const selectedOption = document.getElementById('searchOptions').value;
      const typeInput = document.getElementById('searchType');

      // 선택된 옵션에 따라 type 값을 설정합니다.
      if (selectedOption === '제목') {
        typeInput.value = 'type2';
      } else if (selectedOption === '작성자') {
        typeInput.value = 'type3';
      } else if (selectedOption === '내용') {
          typeInput.value = 'type4';
      } else if (selectedOption === '제목 + 내용') {
          typeInput.value = 'type5';
      } else {
        typeInput.value = 'type1'; // 기본값
      }
    }
  </script>
</body>
</html>
